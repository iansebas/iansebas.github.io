# Claude Code Instructions

## Repository Permissions

Claude has FULL access to this repository folder and can:
- Read, edit, create, and delete any files
- Run any bash commands including git operations
- Execute deployment scripts
- Modify build configurations
- Update dependencies and packages
- Perform file operations (move, copy, rename)
- Access all subdirectories and files

## ⚠️ CRITICAL: DEPLOYMENT PROCESS ⚠️

**VERIFIED WORKING METHOD (Aug 25, 2025)**

When the user says "deploy", run the following command:

```bash
./deploy.sh
```

**⚠️ CRITICAL TECHNICAL DETAILS ⚠️**

**What this does:**
1. Commits all changes to the `master` branch
2. Pushes code to GitHub
3. Builds the Next.js project with static export (`npm run build`)
4. Deploys to `live` branch (NOT `gh-pages`) using `npx gh-pages -d out -b live`
5. Cleans up build artifacts

**⚠️ DEPLOYMENT TARGET: `live` branch (NOT `gh-pages`) ⚠️**

- GitHub Pages serves from the `live` branch
- The script uses: `npx gh-pages -d out -b live -r "$REPO_URL"`
- REPO_URL is dynamically retrieved via `git config --get remote.origin.url`

**After deployment, ALWAYS verify:**
1. Main site works: https://iansebas.github.io/
2. Resume page works: https://iansebas.github.io/resume/
3. PDF files in public/pdfs/ are accessible at: https://iansebas.github.io/pdfs/filename.pdf
4. Test PDF verification: https://iansebas.github.io/pdfs/test-claude.pdf (should contain "i am claude")

## Troubleshooting Deployment Issues

**CRITICAL DEPLOYMENT NOTES & TROUBLESHOOTING:**

**⚠️ Git errors don't necessarily mean deployment failure ⚠️**
- Git pack corruption errors may appear but deployment often succeeds anyway
- Always verify PDFs on live site after deployment regardless of error messages
- Check remote `live` branch for successful pushes: `git ls-remote origin live`

**If deployment appears to fail:**
1. Clear gh-pages cache: `rm -rf node_modules/.cache/gh-pages`
2. Run deployment again: `./deploy.sh`  
3. Verify live site regardless of terminal errors
4. Check PDF accessibility and hashes

**If PDFs still aren't updating after cache clear:**
- GitHub Pages may cache static files for several minutes
- Verify hashes using the verification step above
- Wait 5-10 minutes and check again
- GitHub Pages CDN cache can take time to invalidate

**If build fails:**
```bash
npm install
npm run build
```

**⚠️ CRITICAL DEPLOYMENT NOTES ⚠️**

- The `./deploy.sh` script handles EVERYTHING (code commit + push + deploy)
- GitHub Pages serves from the `live` branch (NOT `gh-pages`)  
- Never use `npm run deploy:ci` unless specifically asked - use `./deploy.sh`
- Git pack corruption errors are common but don't indicate deployment failure
- Always verify PDF accessibility on live site after deployment
- Remote branches: `origin/live` (serves content) and `origin/gh-pages` (legacy)

**AUTOMATED DEPLOYMENT TESTING:**

**⚠️ CRITICAL: Use ./test-deployment.sh to verify deployment works ⚠️**

Before claiming deployment success, ALWAYS run:
```bash
./test-deployment.sh
```

This script:
- Creates unique test PDF with timestamp
- Deploys to live site
- Waits for CDN propagation (45+ seconds)
- Verifies PDF accessibility with retries
- Compares file hashes for integrity
- Cleans up test artifacts
- Reports PASS/FAIL with evidence

**CDN DELAY IMPORTANT:**
- GitHub Pages uses Fastly CDN
- New files take 30-60 seconds to propagate
- Test script accounts for this delay
- Manual verification may show 404 initially

**DEPLOYMENT VERIFICATION EVIDENCE:**
- Working method identified from commit 1916455 analysis (deployment 23)
- Test deployment verified Aug 25, 2025 with automated testing
- PDFs confirmed accessible: test-claude.pdf  
- Live branch contains current content with correct file hashes
- Automated test script validates deployment reliability
- Claude has full permissions to modify any aspect of this codebase

## PDF Display Features

- Resume is displayed at `/resume` using an embedded iframe
- PDF refreshes automatically on every page visit
- Manual refresh button available
- Download functionality included
- Fallback links if PDF doesn't display

## Directory Structure

- Source code: `master` branch
- Live site: `gh-pages` branch (auto-generated by deployment)
- PDFs: `public/pdfs/` folder → accessible at `/pdfs/filename.pdf` on live site
- Build artifacts: `out/` folder (temporary, cleaned after deploy)

## Development Commands

- `npm run dev` - Start development server
- `npm run build` - Build and export static site
- `npm install` - Install dependencies
- `./deploy.sh` - Full deployment process