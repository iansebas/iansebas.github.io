# Claude Code Instructions

## Repository Permissions

Claude has FULL access to this repository folder and can:
- Read, edit, create, and delete any files
- Run any bash commands including git operations
- Execute deployment scripts
- Modify build configurations
- Update dependencies and packages
- Perform file operations (move, copy, rename)
- Access all subdirectories and files

## Deployment Process

When the user says "deploy", run the following command:

```bash
./deploy.sh
```

**What this does:**
1. Commits all changes to the `master` branch
2. Pushes code to GitHub
3. Builds the Next.js project with static export
4. Deploys to `gh-pages` branch (which serves the live site at https://iansebas.github.io/)
5. Cleans up build artifacts

**After deployment, ALWAYS verify:**
1. Main site works: https://iansebas.github.io/
2. Resume page works: https://iansebas.github.io/resume/
3. PDF files in public/pdfs/ are accessible at: https://iansebas.github.io/pdfs/filename.pdf
4. Example: https://iansebas.github.io/pdfs/wanderings.pdf
5. **CRITICAL**: Download the live PDF and verify its hash matches the local repo version:
   ```bash
   # Download live PDF
   curl -o /tmp/live_wanderings.pdf https://iansebas.github.io/pdfs/wanderings.pdf
   # Compare hashes
   shasum public/pdfs/wanderings.pdf
   shasum /tmp/live_wanderings.pdf
   ```
   If hashes don't match, the old PDF is still cached - wait a few minutes and check again.

## Troubleshooting Deployment Issues

**CRITICAL FIX - If PDFs/files aren't updating on live site:**
This happens when the gh-pages cache becomes stale and deployments say "Published" but don't actually push to GitHub:
```bash
rm -rf node_modules/.cache/gh-pages
./deploy.sh
```
**Root cause**: The gh-pages npm package caches the repository locally. If this cache gets corrupted or stale, deployments appear to succeed but don't push to GitHub. Clearing the cache forces a fresh deployment.

**If deployment fails with "branch already exists" error:**
```bash
rm -rf node_modules/.cache/gh-pages
./deploy.sh
```

**If PDFs still aren't updating after cache clear:**
- GitHub Pages may cache static files for several minutes
- Verify hashes using the verification step above  
- Wait 5-10 minutes and check again
- GitHub Pages CDN cache can take time to invalidate

**If build fails:**
```bash
npm install
npm run build
```

## Important Notes

- The `./deploy.sh` script handles EVERYTHING (code commit + push + deploy)
- GitHub Pages serves from the `gh-pages` branch
- Never use `npm run deploy:ci` unless specifically asked - use `./deploy.sh`
- All git operations are automated in the deployment script
- Claude has full permissions to modify any aspect of this codebase

## PDF Display Features

- Resume is displayed at `/resume` using an embedded iframe
- PDF refreshes automatically on every page visit
- Manual refresh button available
- Download functionality included
- Fallback links if PDF doesn't display

## Directory Structure

- Source code: `master` branch
- Live site: `gh-pages` branch (auto-generated by deployment)
- PDFs: `public/pdfs/` folder â†’ accessible at `/pdfs/filename.pdf` on live site
- Build artifacts: `out/` folder (temporary, cleaned after deploy)

## Development Commands

- `npm run dev` - Start development server
- `npm run build` - Build and export static site
- `npm install` - Install dependencies
- `./deploy.sh` - Full deployment process